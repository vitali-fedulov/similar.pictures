<!-- Copyright: Vitali Fedulov (fedulov.vitali@gmail.com) 2015-2023 -->
<!DOCTYPE html>
<html lang="en">
<head>


 
<script async src="//www.googletagmanager.com/gtag/js?id=G-2JHEHHKWBJ"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'G-2JHEHHKWBJ');
</script>


 <title>JPEG embedded thumbnail reader</title>
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto">
 <link rel="icon" type="image/png" href="images/favicon.png">
 <link rel="stylesheet" type="text/css" href="css/clustering.css">
</head>


<body>

 


 <div class="flex-container-select-files">
 <div class="flex-center-horizontally">
 <div>
 <h2 class="text-centered clustering-title">JPEG Embedded Thumbnail Reader</h2>
 </div>

 <div id="terms-of-service">
 <p class="terms-of-service-header text-centered">Terms of service and data protection</p>
 
 <div id="terms"></div>
 </div>

 <div>

 <p id="messages" class="hidden">Messages</p>

 <div id="ok-button" class="text-centered">
 <div class="button">OK</div>
 </div>

 <div id="file-selector" class="text-centered">
 <input class="hidden" type="file" id="filesSelected" webkitdirectory multiple accept="image/*" onchange="v30(this.files)" onclick="v10()">
 <a class="button">Select a folder with images</a>
 </div>

 <div class="link-block text-centered">
 <a class="home-cancel-link" id="cancel-link" onclick="v33()">Cancel</a>
 <a class="home-cancel-link" href="/">Home</a>
 </div>

 </div>

 </div>
 
 </div> 
 
 

 


 <div class="fixed-top hidden">

 <div class="fixed-top-gray">
 <a href = "index.html" class="logo-href"><span class="logo">JPEG Embedded Thumbnail Reader</a>
 <div class="button button-new-search">New read</div>
 </div>

 <div class="fixed-white-1">
 <div class="progress">
 <div id="progress-bar"></div>
 </div>
 <div class="progress-text"></div>
 </div>

 <div class="fixed-white-2 hidden">
 <span class="found-clusters"></span> <span> (</span><span class="view-list">show/hide as list</span><span>)</span>
 <textarea class="textarea"></textarea>
 <p class="explanation">
 <small class="small">Scroll down to view all thumbnails.</small>
 </p>
 </div>

 </div>
 
 <div id="clusters" class="clusters"></div>
 


<script>

function load(url, element) {
 fetch(url)
 .then(response => response.text())
 .then(data => {
 element.innerHTML = data;
 })
 .catch(error => {
 console.error('Error:', error);
 });
}
window.addEventListener('DOMContentLoaded', () => {
 load("tos_en.html", document.querySelector("#terms"));
 document.querySelector("#ok-button").style.display = 'none';
 document.querySelector("#cancel-link").style.display = 'none';
 document.querySelector(".button-new-search").addEventListener('click', (e) => {
 v41();
 });
 document.querySelector("#ok-button").addEventListener('click', (e) => {
 v41();
 });
 window.scrollTo({top: 0});
});

var v51 = {

 v29 : 80000, v5 : 50*1024*1024, v46 : 0, v40 : 0, v13 : Date.now(),

 v34 : 0,

 v27 : [], v49 : "image/jpeg",
 v48 : "",
 v24 : (function () {
 var v12 = new Uint32Array(10); window.crypto.getRandomValues(v12);
 var v28 = "";
 for (var i = 0; i < v12.length; i++) {
 v28 += v12[i].toString(36); }
 return v28
 }) (),

 v61 : null,
 v39 : 0,

 v1 : 1000,
 v0 : null,
 v23 : '\n',
 v11 : 0,
 v8 : false,
 v7 : 0,
};


function v4() { return Math.floor((Date.now() - v51.v13) / 1000);
}


function v33() {
 v41();
}


function v41() {
 location.reload();
 window.scrollTo({top: 0});
}


var v26 = document.getElementById('file-selector');
v26.addEventListener('click', v19);


function v19() {
 var v64 = document.getElementById('filesSelected');
 if (!!v64.webkitdirectory == false) {
 alert('This browser does not support folder selection. Please try latest Chrome, Firefox or Edge.');
 return;
 }
 v64.click();
}


function v25(v63, v58, v47) {
 var v57 = new FileReader();
 v57.readAsArrayBuffer(v51.v61[v58].slice(0, v51.v29));
 v57.onload = function (v62) {
 var v60 = new Uint8Array(v62.target.result),
 v65, v72;
 for (var v74 = 2; v74 < v60.length; v74++) {
 if (v60[v74] == 0xFF) {
 if (!v65) {
 if (v60[v74 + 1] == 0xD8) {
 v65 = v74;
 }
 } else {
 if (v60[v74 + 1] == 0xD9) {
 v72 = v74 + 2; break;
 }
 }
 }
 }
 if (v65 && v72) {
 v47(new Blob([v60.subarray(v65, v72)], {type:v51.v49}));
 } else {
 v47(null);
 }
 };

 v57.onerror = function() {
 v47(null);
 };
}


function v17(v58) {
 if (v51.v11 == 0) {
 document.querySelector(".fixed-top").style.display = 'none';
 document.querySelector(".flex-container-select-files").style.display = 'block';
 document.querySelector("#messages").textContent = "No images with embedded thumbnails found. Please select a different folder.";
 document.querySelector("#messages").style.display = 'block';
 document.querySelector("#file-selector").style.display = 'none';
 document.querySelector("#cancel-link").style.display = 'none';
 document.querySelector("#ok-button").style.display = 'block';
 return;
 }
 document.querySelector(".progress").parentNode.removeChild( document.querySelector(".progress"));
 var v73 = "s";
 if (v58 + 1 == 1) {
 v73 = "";
 }
 v9(".progress-text", "Successfully scanned ".concat(v51.v61.length, " file", v73, "."));
 if (v51.v34 == 0) {
 v9(".progress-text", "Zero thumbnails found from the successfully scanned ".concat(v51.v61.length, " file", v73, "."));
 }
 return;
}


function v9(v16, v68) {
 document.querySelector(v16).textContent = v68;
}

function v2() {
 var v73 = "s";
 if (v51.v34 == 1) {
 v73 = "";
 }
 v9(".found-clusters", "Found ".concat(v51.v34, ' embedded thumbnail', v73));
}

var v35 = document.querySelector("#progress-bar");

function v3(v58) {
 if (v58 + 1 == v51.v39) {
 return;
 }
 v9(".progress-text", "Please wait... Reading ".concat(v58, ' from ', v51.v39, ' selected files.'));
 var v52 = Math.floor(100 * (v58 + 1) / v51.v39);
 if (v52 < 5) {
 v52 = 5;
 }
 v35.style.width = "".concat(v52, "%");
}
function v56(v32, v21) {
 var v67 = document.createElement("div");
 v67.className = v32;
 v21.appendChild(v67);
 return v67;
}

var v31 = document.getElementById("clusters");

function v6(v45) {
 var v37 = v56("cluster", v31);
 var v44 = v56("cluster-num", v37);
 v44.textContent = v45;
 var v20 = v56("cluster-content", v37);
 v56("cluster-imgs", v20);
 v56("cluster-paths", v20);
}


function v14(v45, v63, v71) {
 var v53 = document.querySelectorAll( ".cluster-imgs" )[v45];
 var v59 = v56("cluster-img-div", v53);
 v71.classList.add("cluster-img");
 v59.appendChild(v71);
 var v36 = v56("image-size", v59);
 v36.textContent = "".concat(v71.width, "Ã—", v71.height);
 var v18 = document.querySelectorAll( ".cluster-paths" )[v45];
 var v43 = v56("img-path", v18);
 var v70 = v51.v61[v51.v27[v63]];
 v43.textContent = v70.webkitRelativePath;
 v51.v7++;
}

function v38() {
 var v69 = "";
 var v54 = document.querySelectorAll(".img-path");
 for (v75 = 0; v75 < v54.length; v75++) {
 var v55 = v54[v75].textContent;
 v69 = v69.concat(v55, v51.v23);
 }
 v69 = v69.slice(0, -1); document.querySelector(".textarea").value = v69;
 document.querySelector(".textarea").classList.toggle("textareaon");
}

function v10() {
 document.querySelector("#terms-of-service").style.display = 'none';
 v51.v0 = setTimeout(function() {
 document.querySelector("#messages").textContent = 'Please wait if you selected a very large number of images: it may take tens of seconds before the clustering starts.';
 document.querySelector("#messages").style.display = 'block';
 document.querySelector("#file-selector").style.display = 'none';
 document.querySelector("#cancel-link").style.display = 'block';
 }, v51.v1);
}


function v30(v61) {
 v51.v7 = 0;
 clearTimeout(v51.v0);
 document.querySelector("#file-selector").style.display = 'none';
 v51.v61 = v61;
 v51.v48 = v61[0].webkitRelativePath.split("/")[0];
 v51.v39 = v61.length;
 var v58 = 0; var v63 = 0;
 document.querySelector(".flex-container-select-files").style.display = 'none';
 document.querySelector(".fixed-top").style.display = 'block';
 document.querySelector(".view-list").addEventListener('click', (e) => {
 v38();
 });
 document.querySelector(".fixed-white-2").style.display = 'block';
 v2();
 v22(v58, v63);
}
function v22(v58, v63) {
 
 if (v58 >= v51.v39) {
 v17(v58);
 return;
 }

 if (v58 < 5 || v58 % 5 === 0) {
 v3(v58);
 }

 if (!v51.v49 == v51.v61[v58].type || v51.v61[v58].size > v51.v5) {
 v58++;
 v22(v58, v63);
 return;
 }

 v51.v46 = v63 + 1;

 v25(v63, v58, function(v66) {
 
 if (v66 == null) {
 v58++;
 v63++;
 v22(v58, v63);
 return;

 } else {
 
 var v71 = new Image();

 v71.onload = function() {
 
 v51.v11++;

 v51.v27[v63] = v58;
 v51.v40 = v58 + 1;

 v51.v34++;
 v6(v51.v34);
 v14(v51.v34 - 1, v63, v71);
 
 v58++;
 v63++;
 if (!v51.v8) {
 v51.v8 = true;
 }

 URL.revokeObjectURL(v71.src); v2();
 v22(v58, v63);
 return;
 };

 v71.onerror = function() {
 URL.revokeObjectURL(v71.src); v58++;
 v63++;
 v22(v58, v63);
 return;
 };

 v71.src = URL.createObjectURL(v66);

 return;
 }
 });
}


</script> 
</body>
</html>